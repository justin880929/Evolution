<div class="container-xxl flex-grow-1 container-p-y">
  <!-- 步驟條 -->
  <div class="card mb-md-3 p-md-3">
    <p-steps [model]="steps" [activeIndex]="currentStep" [readonly]="true" class="mb-4"></p-steps>
  </div>
  <!-- 表單內容卡片 -->
  <div class="card p-4">
    <form *ngIf="steps[currentStep]?.label === '建立課程'" [formGroup]="courseForm">
      <div class="mb-3">
        <label class="form-label">課程標題</label>
        <input type="text" class="form-control" formControlName="CourseTitle" />
      </div>

      <div class="mb-3">
        <label class="form-label">課程描述</label>
        <textarea class="form-control" formControlName="CourseDes"></textarea>
      </div>

      <div class="mb-3">
        <label class="form-label d-block">是否公開</label>
        <div class="form-check form-check-inline">
          <p-radioButton name="IsPublic" value="true" inputId="public-yes" formControlName="IsPublic"></p-radioButton>
          <label for="public-yes" class="form-check-label ms-1">是</label>
        </div>
        <div class="form-check form-check-inline">
          <p-radioButton name="IsPublic" value="false" inputId="public-no" formControlName="IsPublic"></p-radioButton>
          <label for="public-no" class="form-check-label ms-1">否</label>
        </div>
      </div>

      <div class="mb-3">
        <label class="form-label">課程價格</label>
        <input type="number" class="form-control" formControlName="Price" />
      </div>

      <div class="mb-3">
        <label class="form-label">課程封面</label>
        <input type="file" class="form-control" (change)="onCoverSelected($event)" accept=".jpg,.jpeg,.png" />
        <img [src]="coverPreviewUrl" class="img-thumbnail mt-2" style="max-width: 300px;" *ngIf="coverPreviewUrl" />
      </div>
    </form>
    <!-- 按鈕控制區 -->
    <div class="mt-4 d-flex justify-content-between">
      <!-- 上一步 -->
      <div>
        <button *ngIf="currentStep>0" [disabled]="lockButton" class="btn btn-secondary" (click)="onPrev()">上一步</button>
      </div>
      <div class="d-flex gap-2">
        <button *ngIf="showEditButton" class="btn btn-warning" (click)="EditSteps()" [disabled]="lockButton">
          儲存資料修改
        </button>
        <button *ngIf="currentStep>1&&currentStep===steps.length-1&&steps[currentStep].label!=='確認建立課程'"
          class="btn btn-danger" (click)="removeLastStep()" [disabled]="lockButton">
          刪除此步驟
        </button>
        <!-- 步驟過程中的下一步 -->
        <button *ngIf="currentStep<steps.length-1&&steps[currentStep].label!=='確認建立課程'" class="btn btn-primary"
          (click)="onNext()" [disabled]="lockButton">
          下一步
        </button>

        <!-- 只有在最後一步，才顯示 addNewSteps -->
        <button [disabled]="lockButton" *ngIf="currentStep === steps.length - 1 &&steps[currentStep].label!=='確認建立課程'"
          class="btn btn-primary" (click)="addNewSteps()">
          下一步
        </button>

        <!-- <button *ngIf="isFinalStep&&(currentStep===steps.length-1)" class="btn btn-success" (click)="finalizeCourse()">
        確認建立
      </button> -->
        <!-- <button class="btn btn-success" (click)="finalizeCourse()">
        檢查
      </button> -->
      </div>
    </div>
    <!-- 顯示上傳進度 -->
    <p-progressBar *ngIf="isUploading" [value]="progressPercent"></p-progressBar>
    <!-- PrimeNG ConfirmDialog & Toast -->
    <p-confirmDialog></p-confirmDialog>
    <p-toast></p-toast>
  </div>